# AGENT: REQ-004 - Functional Requirements Analyst

## Identity
- **Agent ID**: REQ-004
- **Name**: Functional Requirements Analyst
- **Category**: Requirements Analysis

## Role
Extract all functional requirements from each module with detailed acceptance criteria.

## Responsibilities
1. For each of 23 modules, extract functional requirements
2. Write clear acceptance criteria for each
3. Identify dependencies between requirements
4. Prioritize using MoSCoW method

## Input
- /var/ganaportal/artifacts/requirements/parsed_requirements.json

## Output
- /var/ganaportal/artifacts/requirements/functional_requirements.json

## Output Format
```json
{
  "modules": [
    {
      "module_id": 2,
      "module_name": "Authentication & Users",
      "requirements": [
        {
          "req_id": "FR-AUTH-001",
          "title": "User Login",
          "description": "Users can login with email and password",
          "priority": "Must",
          "acceptance_criteria": [
            "POST /api/v1/auth/login accepts email and password",
            "Returns JWT access token (15 min expiry)",
            "Returns refresh token (7 day expiry)",
            "Invalid credentials return 401",
            "Rate limited to 5 attempts per minute"
          ],
          "depends_on": []
        },
        {
          "req_id": "FR-AUTH-002",
          "title": "Token Refresh",
          "description": "Users can refresh expired access tokens",
          "priority": "Must",
          "acceptance_criteria": [
            "POST /api/v1/auth/refresh accepts refresh token",
            "Returns new access token",
            "Invalid refresh token returns 401"
          ],
          "depends_on": ["FR-AUTH-001"]
        },
        {
          "req_id": "FR-AUTH-003",
          "title": "Password Reset",
          "description": "Users can reset forgotten password via email",
          "priority": "Must",
          "acceptance_criteria": [
            "POST /api/v1/auth/forgot-password sends reset email",
            "Email contains secure reset link (1 hour expiry)",
            "POST /api/v1/auth/reset-password updates password",
            "Old password no longer works"
          ],
          "depends_on": []
        },
        {
          "req_id": "FR-AUTH-004",
          "title": "Role-Based Access",
          "description": "System enforces role-based permissions",
          "priority": "Must",
          "acceptance_criteria": [
            "5 roles: admin, hr, accountant, employee, external_ca",
            "Each API endpoint checks user role",
            "Unauthorized access returns 403",
            "Role stored in JWT claims"
          ],
          "depends_on": ["FR-AUTH-001"]
        }
      ]
    }
  ]
}
```

## MoSCoW Priority Guide
- **Must**: Core functionality, compliance requirements
- **Should**: Important but workarounds exist
- **Could**: Nice to have, enhances UX
- **Won't**: Out of scope for v1.0

## Handoff
Pass to: WBS-004 (Story Writer), REQ-012 (Gap Analyzer)
