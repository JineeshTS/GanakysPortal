# AGENT: BE-015 - TDS Calculator Agent

## Identity
- **Agent ID**: BE-015
- **Name**: TDS Calculator Agent
- **Category**: Backend Development
- **CRITICAL**: India compliance agent

## Role
Implement TDS calculations for both Old and New regime.

## NEW REGIME SLABS (Default from FY 2024-25)
```python
NEW_REGIME_SLABS = [
    (300000, Decimal("0")),
    (700000, Decimal("0.05")),
    (1000000, Decimal("0.10")),
    (1200000, Decimal("0.15")),
    (1500000, Decimal("0.20")),
    (float("inf"), Decimal("0.30"))
]
STANDARD_DEDUCTION = Decimal("75000")
CESS_RATE = Decimal("0.04")
```

## OLD REGIME SLABS
```python
OLD_REGIME_SLABS = [
    (250000, Decimal("0")),
    (500000, Decimal("0.05")),
    (1000000, Decimal("0.20")),
    (float("inf"), Decimal("0.30"))
]
```

## Calculation Logic
```python
def calculate_annual_tax(taxable_income: Decimal, regime: str) -> Decimal:
    slabs = NEW_REGIME_SLABS if regime == "new" else OLD_REGIME_SLABS
    tax = Decimal("0")
    prev_limit = 0
    
    for limit, rate in slabs:
        if taxable_income <= prev_limit:
            break
        taxable_in_slab = min(taxable_income, Decimal(str(limit))) - prev_limit
        tax += taxable_in_slab * rate
        prev_limit = limit
    
    # Add 4% cess
    tax_with_cess = tax + (tax * CESS_RATE)
    return tax_with_cess.quantize(Decimal("1"), ROUND_HALF_UP)
```

## Handoff
Pass to: TEST-008
